.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
theme(axis.text.x = element_text(angle = 90,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
theme(axis.text.x = element_text(angle = 600,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
theme(axis.text.x = element_text(angle = 70,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2,
vjust = 0.1))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2,
vjust = 1))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2,
vjust = 0))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2,
vjust = 0.5))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
coord_cartesian(ylim = c(-3, 3), ) +
scale_y_continuous(breaks  = seq(-3,3,1)) +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom"
# ,"Germany", "France"
)) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
coord_cartesian(ylim = c(-3, 3), ) +
scale_y_continuous(breaks  = seq(-3,3,1)) +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America"
# , "United Kingdom"
# ,"Germany", "France"
)) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
coord_cartesian(ylim = c(-3, 3), ) +
scale_y_continuous(breaks  = seq(-3,3,1)) +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_smooth(size = 2, se = F, span = 0.7) +
# geom_point(size = 3, alpha = 1, shape = 5) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
coord_cartesian(ylim = c(-3, 3), ) +
scale_y_continuous(breaks  = seq(-3,3,1)) +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
geom_smooth(size = 2, se = F, span = 0.7) +
# geom_point(size = 3, alpha = 1, shape = 5) +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
coord_cartesian(ylim = c(-3, 3), ) +
scale_y_continuous(breaks  = seq(-3,3,1)) +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
geom_smooth(size = 2, se = F, span = 0.7) +
# geom_point(size = 3, alpha = 1, shape = 5) +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
coord_cartesian(ylim = c(-2, 2), ) +
scale_y_continuous(breaks  = seq(-2,2,1)) +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2))
runApp()
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom", "Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)])) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(year, value, color = name)) +
geom_point(color = "lightgrey", show.legend = F, alpha = 0.3) +
geom_hline(yintercept = 0, color = "black", size = 1) +
geom_hline(yintercept = 1, color = "black", size = 1) +
geom_smooth(aes(group = NA),
se = F,
color = "#386cb0",
size = 1.5,
method = "loess",
span = 0.7) +
geom_smooth(
method = "loess", span = 0.7,
#  formula = y ~ x + I(x^2),
show.legend = F,
aes(group = NULL),
color = "#ef3b2c",
se = F,
size = 1.5
) +
coord_cartesian(ylim = c(-3, 3), ) +
scale_y_continuous(breaks  = seq(-3,3,1)) +
theme_Publication() +
scale_colour_Publication() +
theme(panel.grid.major = element_blank()) +
labs(
subtitle = '<span style="color:#ef3b2c;"><strong>smooth loess</strong></span>, <span style="color:#386cb0;"><strong>weighted to GDP</strong></span>,<br> span: 0.7, screen: > 0.01',
caption = "Data from World Inequality Database") +
facet_grid(cols = vars(country),
rows = vars(group))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
geom_smooth(size = 2, se = F, span = 0.7) +
# geom_point(size = 3, alpha = 1, shape = 5) +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
coord_cartesian(ylim = c(-2, 2), ) +
scale_y_continuous(breaks  = seq(-2,2,1)) +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2))
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
geom_smooth(size = 2, se = F, span = 0.7) +
# geom_point(size = 3, alpha = 1, shape = 5) +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
coord_cartesian(ylim = c(-2, 2), ) +
scale_y_continuous(breaks  = seq(-2,2,1)) +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2),
axis.title.y = element_blank())
runApp()
runApp()
runApp()
runApp()
runApp()
wid_reg |>
filter(country %in% c("United States of America", "United Kingdom",
"Germany", "France")) |>
rowwise() |>
mutate(group = list(thresholds[thresholds > abs(`𝚫g(K)`)]),
country = case_match(country,
"United States of America" ~ "USA",
"United Kingdom" ~ "UK",
.default = country)) |>
unnest(group) |>
filter(dataset == "pwt") |>
ggplot(aes(x = year, y = value, color = name)) +
geom_hline(yintercept = 1, size = 1, linetype = "dashed") +
geom_hline(yintercept = 0, size = 1, linetype = "dashed") +
geom_smooth(size = 2, se = F, span = 0.7) +
# geom_point(size = 3, alpha = 1, shape = 5) +
facet_grid(cols = vars(country), rows = vars(group),
scales = "free_y") +
theme_Publication() +
scale_colour_Publication() +
scale_x_continuous(position = "top") +
coord_cartesian(ylim = c(-2, 2), ) +
scale_y_continuous(breaks  = seq(-2,2,1)) +
theme(axis.text.x = element_text(angle = 60,
hjust = 0.2),
axis.title.y = element_blank())
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
styler:::style_selection()
runApp()
runApp()
source("~/Documents/GitHub/RProjects/Getty/app/RhinoApplication/app/view/four_country_plots.R", echo=TRUE)
source("~/Documents/GitHub/RProjects/Getty/app/RhinoApplication/app/view/four_country_plots.R", echo=TRUE)
runApp()
runApp()
runApp()
shiny::runApp()
